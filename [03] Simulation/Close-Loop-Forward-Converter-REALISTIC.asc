Version 4
SHEET 1 3256 1688
WIRE -704 -256 -736 -256
WIRE -624 -256 -704 -256
WIRE -560 -256 -624 -256
WIRE -368 -256 -560 -256
WIRE -112 -256 -272 -256
WIRE -16 -256 -112 -256
WIRE 48 -256 -16 -256
WIRE 192 -256 128 -256
WIRE 336 -256 192 -256
WIRE 464 -256 400 -256
WIRE 688 -256 624 -256
WIRE 896 -256 752 -256
WIRE 960 -256 896 -256
WIRE 1104 -256 1040 -256
WIRE 1216 -256 1104 -256
WIRE 1344 -256 1216 -256
WIRE 1424 -256 1344 -256
WIRE 1456 -256 1424 -256
WIRE 1632 -256 1504 -256
WIRE 1776 -256 1632 -256
WIRE 1824 -256 1776 -256
WIRE 1856 -256 1824 -256
WIRE 1856 -240 1856 -256
WIRE -368 -224 -368 -256
WIRE -272 -224 -272 -256
WIRE 1632 -224 1632 -256
WIRE 1776 -224 1776 -256
WIRE -704 -208 -704 -256
WIRE -624 -208 -624 -256
WIRE -560 -208 -560 -256
WIRE -16 -208 -16 -256
WIRE 464 -208 464 -256
WIRE 624 -208 624 -256
WIRE 1104 -192 1104 -256
WIRE 1216 -192 1216 -256
WIRE 192 -176 192 -256
WIRE 896 -176 896 -256
WIRE -320 -144 -320 -160
WIRE -288 -144 -320 -144
WIRE -112 -144 -112 -256
WIRE -112 -144 -208 -144
WIRE 1632 -144 1632 -160
WIRE -320 -128 -320 -144
WIRE 1632 -112 1632 -144
WIRE 1776 -112 1776 -160
WIRE 1856 -112 1856 -160
WIRE -624 -48 -624 -144
WIRE -560 -48 -560 -144
WIRE -560 -48 -624 -48
WIRE -320 -48 -320 -64
WIRE -320 -48 -560 -48
WIRE -16 -48 -16 -144
WIRE -16 -48 -320 -48
WIRE 192 -48 192 -112
WIRE 192 -48 -16 -48
WIRE 464 -48 464 -128
WIRE 464 -48 192 -48
WIRE 624 -48 624 -128
WIRE 896 -48 896 -112
WIRE 896 -48 624 -48
WIRE 1104 -48 1104 -128
WIRE 1104 -48 896 -48
WIRE 1216 -48 1216 -128
WIRE 1216 -48 1104 -48
WIRE -704 0 -704 -128
WIRE 464 0 464 -48
WIRE 624 0 624 -48
WIRE -512 96 -880 96
WIRE 368 96 -512 96
WIRE 464 96 368 96
WIRE 800 96 624 96
WIRE 928 96 800 96
WIRE 976 96 928 96
WIRE 1104 96 1056 96
WIRE 1280 96 1104 96
WIRE 1760 96 1280 96
WIRE 1856 96 1760 96
WIRE 368 112 368 96
WIRE 464 112 464 96
WIRE 624 112 624 96
WIRE 1760 128 1760 96
WIRE 1856 128 1856 96
WIRE -880 144 -880 96
WIRE 1104 144 1104 96
WIRE -512 192 -512 96
WIRE 1984 224 1904 224
WIRE -64 240 -64 160
WIRE 368 256 368 192
WIRE 624 272 624 192
WIRE 928 272 928 96
WIRE -64 288 -64 240
WIRE 1760 288 1760 208
WIRE 1856 288 1760 288
WIRE 1104 304 1104 208
WIRE 1760 304 1760 288
WIRE 1904 304 1904 272
WIRE 1984 304 1904 304
WIRE -880 336 -880 224
WIRE -512 336 -512 272
WIRE -256 336 -512 336
WIRE 144 336 112 336
WIRE 240 336 224 336
WIRE 320 336 240 336
WIRE 720 352 672 352
WIRE -512 368 -512 336
WIRE 464 368 464 192
WIRE 624 400 624 368
WIRE 928 400 928 368
WIRE 976 400 976 352
WIRE 1056 400 976 400
WIRE -352 416 -352 400
WIRE -352 416 -432 416
WIRE -256 416 -352 416
WIRE 192 416 112 416
WIRE 368 416 368 352
WIRE 368 416 240 416
WIRE 720 416 720 352
WIRE 720 416 640 416
WIRE 976 416 976 400
WIRE -352 432 -352 416
WIRE 720 432 720 416
WIRE 1056 432 1056 400
WIRE 640 448 640 416
WIRE 192 464 192 416
WIRE 240 464 192 464
WIRE 256 464 240 464
WIRE 368 464 368 416
WIRE 368 464 336 464
WIRE -512 480 -512 448
WIRE 192 496 192 464
WIRE 192 496 112 496
WIRE -544 512 -624 512
WIRE -352 512 -544 512
WIRE -256 512 -256 496
WIRE -256 512 -352 512
WIRE 240 512 240 464
WIRE 368 512 368 464
WIRE 720 512 640 512
WIRE 976 512 976 496
WIRE 1056 512 1056 496
WIRE 1056 512 976 512
WIRE -544 528 -544 512
WIRE 976 528 976 512
WIRE 720 544 720 512
WIRE -384 576 -448 576
WIRE -256 576 -304 576
WIRE 192 576 112 576
WIRE 368 624 368 592
WIRE 464 624 464 432
WIRE -384 656 -448 656
WIRE -256 656 -304 656
WIRE 144 656 112 656
WIRE 192 656 144 656
WIRE 1280 656 1280 96
WIRE 1696 672 1696 640
WIRE 1696 672 1584 672
WIRE 1696 704 1696 672
WIRE 864 720 864 688
WIRE -384 736 -448 736
WIRE -256 736 -304 736
WIRE 176 736 112 736
WIRE 1888 736 1824 736
WIRE 1504 768 1504 672
WIRE 1568 768 1504 768
WIRE 320 784 256 784
WIRE 448 784 400 784
WIRE 464 784 448 784
WIRE 656 784 640 784
WIRE 1024 784 992 784
WIRE 1088 784 1024 784
WIRE 1280 784 1280 736
WIRE 1280 784 1088 784
WIRE 1024 800 1024 784
WIRE 1088 800 1088 784
WIRE 1936 800 1824 800
WIRE 1968 800 1936 800
WIRE 1280 816 1280 784
WIRE 1936 816 1936 800
WIRE -144 848 -144 800
WIRE 16 848 16 800
WIRE 272 848 224 848
WIRE 384 848 272 848
WIRE 448 848 384 848
WIRE 464 848 448 848
WIRE 1504 848 1504 832
WIRE 1840 864 1824 864
WIRE 384 880 384 848
WIRE 672 880 640 880
WIRE 736 896 720 896
WIRE 1024 896 1024 864
WIRE 1024 896 992 896
WIRE 1472 896 1376 896
WIRE 1568 896 1472 896
WIRE 720 912 720 896
WIRE 1472 912 1472 896
WIRE 1872 928 1824 928
WIRE 1024 944 1024 896
WIRE 1088 944 1024 944
WIRE 1696 976 1696 960
WIRE 672 1008 672 880
WIRE 720 1008 720 976
WIRE 864 1008 864 960
WIRE 1280 1008 1280 896
WIRE 1472 1008 1472 992
WIRE 288 1104 128 1104
WIRE 400 1104 288 1104
WIRE 480 1104 464 1104
WIRE 608 1104 592 1104
WIRE 1376 1104 1376 896
WIRE 1376 1104 688 1104
WIRE 592 1120 592 1104
WIRE 288 1136 288 1104
WIRE 480 1136 480 1104
WIRE 288 1216 288 1200
WIRE 592 1216 592 1200
WIRE 480 1232 480 1216
WIRE -320 1280 -320 1248
WIRE -320 1392 -320 1360
WIRE -1472 1488 -1472 1456
FLAG -64 160 Vaux
FLAG 240 576 0
FLAG -144 848 0
FLAG -448 736 0
FLAG -448 656 0
FLAG -448 576 0
FLAG 144 656 FB
FLAG -544 592 0
FLAG -432 480 0
FLAG -624 592 0
FLAG -352 400 Vref
FLAG -512 480 0
FLAG 1760 304 SEC
FLAG 1280 1008 SEC
FLAG 624 400 SEC
FLAG 928 400 SEC
FLAG 1104 304 SEC
FLAG 864 1008 SEC
FLAG 720 1008 SEC
FLAG 672 1008 SEC
FLAG 384 960 0
FLAG -320 1392 SEC
FLAG 256 784 Vaux
FLAG 208 896 Vref
FLAG 272 944 0
FLAG 144 848 FB
FLAG -1472 1456 Vi
FLAG 464 0 0
FLAG -736 -256 Vaux
FLAG 624 0 SEC
FLAG 16 848 0
FLAG 368 624 0
FLAG 464 624 0
FLAG 0 240 0
FLAG -1472 1568 0
FLAG -880 336 0
FLAG -320 1248 0
FLAG -880 96 Vin
FLAG -704 0 Vin
FLAG 1856 -112 SEC
FLAG 1776 -112 SEC
FLAG 1632 -112 SEC
FLAG 1344 -256 Vc
FLAG 2048 800 FWD
FLAG 1888 736 FG
FLAG 1840 864 CG
FLAG 480 1232 0
FLAG 128 1104 Sout
FLAG 1696 640 VccBias
FLAG 288 1216 0
FLAG 1824 -256 VccBias
FLAG 176 736 Sout
FLAG 720 544 FG
FLAG 976 528 CG
FLAG 800 96 FWD
FLAG 592 1216 SEC
FLAG 1472 1008 SEC
FLAG 1696 976 SEC
FLAG 1872 1008 SEC
FLAG 1936 896 SEC
FLAG 1504 848 SEC
FLAG 864 688 VccBias
SYMBOL res 1744 112 R0
SYMATTR InstName R2
SYMATTR Value {10*RL}
SYMBOL cap 1088 144 R0
SYMATTR InstName C1
SYMATTR Value {Cf}
SYMATTR SpiceLine Rser=20m
SYMBOL diode 480 432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 44 -116 VRight 2
SYMATTR InstName D2
SYMATTR Value RFUH25NS3S
SYMBOL ind2 960 112 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value {Lf}
SYMATTR SpiceLine Rser=50m
SYMATTR Type ind
SYMBOL ind2 480 208 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName ind3
SYMATTR Value {L3}
SYMATTR Type ind
SYMATTR SpiceLine Rser=20m
SYMBOL ind2 608 96 R0
SYMATTR InstName ind2
SYMATTR Value {L2}
SYMATTR Type ind
SYMATTR SpiceLine Rser=20m
SYMBOL ind2 352 96 R0
WINDOW 0 -54 34 Left 2
WINDOW 3 -56 77 Left 2
SYMATTR InstName ind1
SYMATTR Value {L1}
SYMATTR Type ind
SYMATTR SpiceLine Rser=20m
SYMBOL bv -880 128 R0
SYMATTR InstName B1
SYMATTR Value V=V(Vi)
SYMBOL res 352 496 R0
SYMATTR InstName Rs
SYMATTR Value 8m
SYMBOL res 352 448 R90
WINDOW 0 52 87 VBottom 2
WINDOW 3 25 41 VTop 2
SYMATTR InstName R4
SYMATTR Value 47
SYMBOL cap 224 512 R0
WINDOW 0 48 25 Left 2
WINDOW 3 38 45 Left 2
SYMATTR InstName C3
SYMATTR Value 2.2n
SYMBOL res -288 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res -400 672 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 160k
SYMBOL res -400 592 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 178k
SYMBOL cap -560 528 R0
WINDOW 0 54 -4 Left 2
WINDOW 3 40 20 Left 2
SYMATTR InstName C4
SYMATTR Value 2.2n
SYMBOL cap -448 416 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMBOL res -368 416 R0
SYMATTR InstName R9
SYMATTR Value 12k
SYMBOL res -640 496 R0
WINDOW 0 -48 15 Left 2
WINDOW 3 -49 40 Left 2
SYMATTR InstName R10
SYMATTR Value 18k
SYMBOL res -528 176 R0
SYMATTR InstName R11
SYMATTR Value 240k
SYMBOL res -528 352 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL PowerProducts\\LT4430 864 832 R0
SYMATTR InstName U2
SYMBOL res 1264 640 R0
SYMATTR InstName R13
SYMATTR Value 200K
SYMBOL res 1264 800 R0
SYMATTR InstName R14
SYMATTR Value 27k
SYMBOL res 1072 848 R0
SYMATTR InstName R15
SYMATTR Value 8.2k
SYMBOL cap 1072 800 R0
SYMATTR InstName C7
SYMATTR Value 8.2n
SYMBOL cap 736 912 M0
WINDOW 3 19 44 Left 2
SYMATTR Value 100p
SYMATTR InstName C8
SYMBOL res 752 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 860
SYMBOL nmos 320 256 R0
WINDOW 0 95 26 VRight 2
WINDOW 3 69 -30 VRight 2
SYMATTR InstName M1
SYMATTR Value IPB200N25N3
SYMBOL PowerProducts\\LT1952-1 -64 528 R0
SYMATTR InstName U1
SYMBOL res -336 1264 R0
SYMATTR InstName R21
SYMATTR Value 1Meg
SYMBOL res 224 320 R0
SYMATTR InstName R22
SYMATTR Value 10k
SYMBOL res 176 560 R0
WINDOW 3 32 80 Left 2
WINDOW 0 39 52 Left 2
SYMATTR Value 10k
SYMATTR InstName R1
SYMBOL res 416 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 220
SYMBOL res 240 832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 400 976 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 1.2k
SYMBOL pnp 208 944 M180
SYMATTR InstName Q1
SYMATTR Value BC856B
SYMBOL voltage -1472 1472 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -198 134 Left 2
SYMATTR Value PWL(0 0 0.499m 0 0.5m 36 1m 36 2m 36 2.01m 60)
SYMATTR InstName Vi
SYMBOL cap 0 -208 M0
SYMATTR InstName C9
SYMATTR Value 22µ
SYMATTR SpiceLine Rser=2m
SYMBOL diode 400 -240 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value D1
SYMBOL ind2 480 -224 M0
SYMATTR InstName ind4
SYMATTR Value {L4}
SYMATTR Type ind
SYMATTR SpiceLine Rser=20m
SYMBOL cap -576 -208 R0
WINDOW 0 0 97 VRight 2
WINDOW 3 32 110 VRight 2
SYMATTR InstName C10
SYMATTR Value 1µ
SYMBOL zener -608 -144 R180
WINDOW 0 58 -105 VRight 2
WINDOW 3 38 -104 VRight 2
SYMATTR InstName D6
SYMATTR Value PDZV16B
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL npn -272 -160 M270
SYMATTR InstName Q2
SYMATTR Value 2SC5824
SYMBOL res -720 -224 R0
WINDOW 0 -49 41 VRight 2
WINDOW 3 -20 46 VRight 2
SYMATTR InstName R18
SYMATTR Value 4.7k
SYMBOL res -192 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 4.7k
SYMBOL zener -304 -64 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMATTR Value UDZV12B
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL diode 176 -112 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMATTR Value D1
SYMBOL ind 144 -272 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 10µ
SYMBOL cap 1088 -192 R0
SYMATTR InstName C12
SYMATTR Value 10µ
SYMBOL diode 688 -240 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value D1
SYMBOL ind2 608 -224 R0
SYMATTR InstName ind5
SYMATTR Value {L4}
SYMATTR Type ind
SYMATTR SpiceLine Rser=20m
SYMBOL diode 912 -112 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D11
SYMATTR Value D1
SYMBOL ind 944 -272 M90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L2
SYMATTR Value 10µ
SYMBOL res 1840 -256 R0
SYMATTR InstName R20
SYMATTR Value 39
SYMBOL cap 1200 -192 R0
SYMATTR InstName C14
SYMATTR Value 10µ
SYMBOL cap 0 224 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 100µ
SYMBOL cap 1760 -224 R0
SYMATTR InstName C6
SYMATTR Value 22µ
SYMBOL res 1408 -240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R23
SYMATTR Value 1
SYMBOL bv 1632 -240 R0
WINDOW 3 -362 195 Left 2
SYMATTR InstName B2
SYMATTR Value V=if(V(Vc,SEC)<12, V(Vc,SEC), 12)
SYMBOL bv 1984 208 R0
SYMATTR InstName B3
SYMATTR Value V= if(V(Vin) >50,0, 5)
SYMBOL res 1840 112 R0
SYMATTR InstName R24
SYMATTR Value 0.6944
SYMBOL sw 1856 304 R180
SYMATTR InstName S1
SYMATTR Value NMOS
SYMBOL cap 1008 800 R0
SYMATTR InstName C11
SYMATTR Value 220p
SYMBOL PowerProducts\\LTC3900 1696 816 R0
SYMATTR InstName U4
SYMBOL res 1600 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rtmr1
SYMATTR Value 90.9k
SYMBOL cap 1488 768 R0
WINDOW 0 -55 12 Left 2
WINDOW 3 -58 45 Left 2
SYMATTR InstName Ctmr1
SYMATTR Value 0.47n
SYMBOL res 2064 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rcs1
SYMATTR Value 365
SYMBOL res 1952 912 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rcs2
SYMATTR Value 360
SYMBOL res 1888 1024 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rcs3
SYMATTR Value 182
SYMBOL ind2 496 1232 R180
WINDOW 0 39 37 Left 2
WINDOW 3 37 14 Left 2
SYMATTR InstName L3
SYMATTR Value 300µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=13m
SYMBOL ind2 608 1104 M0
WINDOW 0 -28 75 Left 2
WINDOW 3 -57 98 Left 2
SYMATTR InstName L5
SYMATTR Value 300µ
SYMATTR Type ind
SYMATTR SpiceLine Rser=7m
SYMBOL cap 464 1088 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value 220pF
SYMBOL res 1488 1008 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R25
SYMATTR Value 200
SYMBOL cap 272 1136 R0
SYMATTR InstName C15
SYMATTR Value 100p
SYMBOL ind 704 1088 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L6
SYMATTR Value 50n
SYMBOL nmos 672 272 M0
WINDOW 0 -3 -9 Left 2
WINDOW 3 72 105 VLeft 2
SYMATTR InstName M4
SYMATTR Value HAT2266
SYMBOL nmos 976 272 M0
SYMATTR InstName M5
SYMATTR Value HAT2266
SYMBOL res 240 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 0
SYMBOL res 736 416 M0
WINDOW 0 -13 30 VRight 2
WINDOW 3 39 41 VRight 2
SYMATTR InstName R27
SYMATTR Value 25
SYMBOL res 960 400 R0
SYMATTR InstName R28
SYMATTR Value 25
SYMBOL diode 656 448 M0
WINDOW 0 -23 -10 Left 2
WINDOW 3 46 107 VLeft 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode 1040 432 R0
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL Optos\\4N28 544 848 M0
SYMATTR InstName U5
TEXT -1600 -536 Left 2 !.model NMOS SW(Ron=25m Roff=1Meg Vt=.5 Vh=-.4)
TEXT -1600 -512 Left 2 !.model D1 D(Ron=20m Roff=100G Vfwd=0.1)
TEXT -1616 -80 Left 2 !.tran 0 0.1 0 1e-7 startup
TEXT -1600 -448 Left 2 !K1 ind1 ind2 ind3 ind4 ind5 1\nK2 L3 L5 1
TEXT -1528 64 Left 2 !.param L1 190u\n.param L2  30.4u\n.param L3 190u\n.param L4 78u\n.param fs  200k\n.param Cf 220u\n.param RL 0.625\n.param Lf 16u\n.param Laux 20u\n.param Caux 20u
TEXT -1136 40 Left 2 !.ic V(C10) = 8\n.ic V(Vaux) = 8\n.ic V(C2) = 8
TEXT -1600 -560 Left 2 !.model HAT2266 VDMOS(Rg=0.5 Vto=2.3 Rd=4m Rs=1m Rb=5m Kp=70 lambda=.05 Cgdmax=0.65n Cgdmin=.08n Cgs=3.455n Cjo=1.2n Is=120p ksubthres=.1 mfg=Furkan Vds=60 Ron=12m Qg=25n)
LINE Normal 560 1040 560 -256 2
LINE Normal 512 1040 512 -256 2
